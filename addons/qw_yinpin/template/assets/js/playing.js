!function(a){function b(){PageBase.apply(this,arguments)}function c(a){var b=document.createElement("iframe");b.src=" iting://open?msg_type=11&track_id="+a,b.style.display="none",document.body.appendChild(b),window.setTimeout(function(){document.body.removeChild(b)},3e3)}b.prototype=a.extend({},PageBase.prototype),b.prototype.doInit=function(){FastClick.attach(document.body),this.doAddListener(),this.doFixBottomBar();var b=a("[data-origin]").attr("data-origin");if(b){var c=new Image;c.onload=function(){a("[data-origin]").css("backgroundImage","url("+b+")")},c.src=b}};var d=new b,e=a(".page"),f=a(".time.fl"),g=a(".playbar"),h=a("#recommendAlbumTemplate"),i=a("#else1"),j=i.find(".list"),k=h.find("li");i.hide(),a.ajax({url:"/rec-association/recommend/album",dataType:"json",data:{trackId:h.attr("data-track-id")},success:function(b){var c,d,e=a(document.createDocumentFragment()),f=0;if(0==b.ret&&b.albums&&b.albums.length){for(var g in b.albums)if(g=b.albums[g],d=new Date(g.updatedAt),c=k.clone(),c.find("a").attr("href","javascript:;"),c.find(".pic img").attr("src",g.coverSmall),c.find(".name").text(g.title),d&&c.find(".cont").text("最后更新："+d.getFullYear()+"年"+(d.getMonth()+1)+"月"+(d.getDay()+1)+"日"),c.attr("data-url","/album/"+g.albumId),e.append(c),++f>=3)break;i.show(),j.append(e)}},error:function(){}}),j.on("click","[data-url]",d.doLocation),a("#intro-desc").on("click","a.icon-more",function(){var b=a("#intro-desc");return b.toggleClass("open"),b.html(b.hasClass("open")?b.attr("data-text"):b.attr("data-abbr")),!1}),e.find("[sound_id]").on("onplaying",function(a){var b=1e3*a.duration;f.text(helper.getTime(a.position)),g.width((a.position/b*100||0)+"%")}).on("onfinish",function(){g.width("100%")}),a(".btn-more,.btn-open,.btn-dload").on("click",function(){var b=a(this).attr("href"),c=a.cookie("from");c&&a(this).attr("href",d.combineHref(b,{from:c}))}),a("#reward").on("click",function(){var b=a(this),d=a(this).attr("data-id");if(!helper.isInThirdPlatform())try{c(d)}catch(e){}return window.location.href=b.attr("data-redirect"),!1}),soundManager.isOnReady?d.doInit():soundManager.onready(function(){d.doInit()})}($);