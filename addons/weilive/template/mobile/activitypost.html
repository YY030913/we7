<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>添加活动</title>
    <link rel="stylesheet" href="../addons/weilive/style/css/shop.css"/>
    <link rel="stylesheet" href="../addons/weilive/style/css/spinningwheel.css"/>
	<script type="text/javascript">
	function checkdata(){
	var pic_url=document.getElementById('pic_url').value;
	var Activities_name=document.getElementById('Activities_name').value;
	var oldPrice=document.getElementById('oldPrice').value;
	var price=document.getElementById('price').value;
	var sum=document.getElementById('sum').value;
	var endTime=document.getElementById('endTime').value;
	var start_time=document.getElementById('start_time').value;
	var seal_time=document.getElementById('seal_time').value;
	var describe=document.getElementById('describe').value;
	var emp = /^\s*$/;
	
	if(emp.test(Activities_name)){
	alert("亲，请填写活动名称！");
	return false;
	}else if(emp.test(pic_url)){
	alert("亲，图片正在上传中，请稍候提交！");
	return false;
	}else if(emp.test(oldPrice)){
	alert("亲，请填写原价！");
	return false;
	
	}else if(emp.test(price)){
	alert("亲，请填写最低价！");
	return false;
	
	}else if(!emp.test(sum)&&isNaN(sum)){
	alert("亲，请填写有效的阿拉伯数字！不填为无限量！");
	return false;
	}else if(emp.test(start_time)){
	alert("亲，请选择开始时间！");
	return false;
	
	}else if(emp.test(endTime)){
	alert("亲，请选择结束时间！");
	return false;
	
	}else if(emp.test(seal_time)){
	alert("亲，请选择消费截止时间！");
	return false;
	
	}else if(emp.test(describe)){
	alert("亲，请填写活动详情！");
	return false;
	
	}else{
	return true;
	}
	}
	</script>
	<style>
	.m-form .row input[type='tel'], .m-form .row .time {
		width: 100%;
		height: 34px;
		padding: 0 12px;
		border: 1px solid #e1e1e1;
		background-color: #fff;
		outline: none;
		-webkit-box-shadow: none;
		box-shadow: none;
		-webkit-border-radius: 5px;
		border-radius: 5px;
	}
	</style>
</head>
<body>
<div class="app-view">
    <div class="app-page">
        <header class="app-head">
            <div class="inner">
                <a class="link app-back" href="javascript:history.back();">
                    <i class="icon-back"></i>
                </a>
<p style=" float:right;"><a href="{php echo $this->createMobileUrl('myshop', array('op'=>'exit'))}" class=""><input type="button" value="退出" name="" style="color:#666; width:60px; height:28px;"/></a></p>
                <h1 class="title sliding">添加活动</h1>
            </div>
        </header>
        <section class="app-wrap">
            <div class="inner">
                <form class="m-form" enctype="multipart/form-data" onSubmit="return checkdata();" id="fr1" name="fr1" action="{php echo $this->createMobileUrl('myshop', array('op'=>'activitypost', 'opp'=>'post'))}" method="post">
                    <div class="row">
                        <span class="tag">活动图片：</span>
						<input type="file" id="file" name="file" accept="image/*">
						<input type='hidden' id='pic_url' name='logo' value="{$_W['attachurl']}{$active['logo']}"/>
						<label for="headUpload"><span id="aaa"></span><img style="display:block;" id="fileimg" src="../addons/weilive/style/images/home.png" width="120px;" class="hl-bdrs-16 fileimg"></label>
					</div>
					<div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px; color:red;">
                        建议图片为330px:220px
                    </div>
					<div class="row">
                        <span class="tag">活动名称：</span>
                        <input type="text" id="Activities_name" name="title"/>
                    </div>
					<div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px; color:red;">
                        您的活动商品或服务名称
                    </div>
                    <div class="row">
                        <span class="tag">原价：</span>
                        <input type="tel" id="oldPrice" name="price"/>
                    </div>
                    <div class="row">
                        <span class="tag">秒杀价：</span>
                        <!--<input type="text" id="price" name="price"/>-->
						<select id="price" name="kill_price">
						<option value="1" selected="selected">1元</option>
						<option value="2">2元</option>
						<option value="3">3元</option>
						<option value="4">4元</option>
						<option value="5">5元</option>
						</select>
                    </div>
					<div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px; color:red;">
                        该商品所限制的最低价格
                    </div>
                    <div class="row">
                        <span class="tag">数量：</span>
                        <input type="tel" id="sum" name="num"/>
                    </div><div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px;">
                        提示：不填写则为不限量
                    </div>
					<div class="row">
						
                        <span class="tag">开始时间：</span>

                        <div class="time1" id="js_times" style=" border:1px solid #e1e1e1; border-radius: 5px;">
                            <div class="text"></div>
                            <input type="text" style="border:0;" readonly="true" id="start_time" name="start_time" value="{php echo date('Y-m-d h:i:s', time())}"/>
                        </div>
                    </div>
					<div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px; color:red;">
                        该活动的开始时间
                    </div>
                    <div class="row">
                        <span class="tag">结束时间：</span>

                        <div class="time1" id="js_time" style=" border:1px solid #e1e1e1; border-radius: 5px;">
                            <div class="text"></div>
                            <input type="text" style="border:0;" readonly="true" id="endTime" name="end_time" value="{php echo date('Y-m-d h:i:s', time()+3600*168)}"/>
                        </div>
                    </div>
					<div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px; color:red;">
                        该活动的使用截止时间
                    </div>
					<div class="row">
						
                        <span class="tag">消费截止：</span>

                        <div class="time1" id="js_times1" style=" border:1px solid #e1e1e1; border-radius: 5px;">
                            <div class="text"></div>
                            <input type="text" style="border:0;" readonly="true" id="seal_time" name="cost_time" value="{php echo date('Y-m-d h:i:s', time()+3600*168*2)}"/>
                        </div>
                    </div>
					<div class="msg" style="margin-top:0; margin-bottom:0; margin-left:80px; color:red;">
                        该活动的开始时间
                    </div>
                    <div class="row">
                        <span class="tag">活动详情：</span>
                        <textarea  id="describe" name="activity_detail"></textarea>
                    </div>
					<input type="hidden" name="storeid" value="{$storeid}"/>
					<input type="hidden" name="token" value="{$_W['token']}" />
                    <input name="submit" class="submit" type="submit" value="提交">

                    <div class="msg">
					<!--<a href="http://www.baidu.com">活动说明</a><br/>-->
                        提示：资料提交后需要审核，如需快速审核，请电话联系我们：{$setting['mobile']}
                    </div>
                </form>
            </div>
        </section>
    </div>
</div>
</body>
<script charset="utf-8" src="../addons/weilive/style/js/zepto.min.js"></script>
<script charset="utf-8" src="../addons/weilive/style/js/spinningwheel-min.js"></script>
<script src="../addons/weilive/style/js/jquery.1.11.1.js"></script>
<script>
    $(function () {
        var ifShow = false;
        var $box = $("#js_time");
        var $time = $box.find('input');
        var $text = $box.find('.text');
        $box.on('click', function () {
            if (ifShow) {
                return;
            }
            ifShow = true;
            var now = new Date();
            var days = {};
            var years = {};
            var months = { 1: '1月', 2: '2月', 3: '3月', 4: '4月', 5: '5月', 6: '6月', 7: '7月', 8: '8月', 9: '9月', 10: '10月', 11: '11月', 12: '12月' };
            var hours = {};
            var minute = {}

            for (var i = 0; i < 24; i++) {
            }

            for (var i = 0; i < 60; i++) {
                minute[i.length == 1 ? '0' + i : i] = i.length == 1 ? '0' + i : i;
                if (i < 24) {
                    hours[i] = i;
                }
                if (i < 31) {
                    days[i + 1] = i + 1;
                }
            }


            for (i = now.getFullYear(); i < now.getFullYear() + 20; i++) {
                years[i] = i;
            }

            SpinningWheel.addSlot(years, 'right', now.getFullYear());
            SpinningWheel.addSlot(months, 'right', now.getMonth() + 1);
            SpinningWheel.addSlot(days, 'right', now.getDate());
            SpinningWheel.addSlot(hours, 'right', now.getHours());
            SpinningWheel.addSlot(minute, 'right', now.getMinutes());

            SpinningWheel.setCancelAction(function () {
                ifShow = false;
            });
            SpinningWheel.setDoneAction(function () {
                var results = SpinningWheel.getSelectedValues();
                var times = results.keys.toString().split(',');
                $text.html();
                $time.val(times[0] + '-' + times[1] + "-" + times[2] + ' ' + times[3] + ':' + times[4]);
                ifShow = false;
            });

            SpinningWheel.open();
        });
    })
</script>

<script>
    $(function () {
        var ifShow = false;
        var $box = $("#js_times");
        var $time = $box.find('input');
        var $text = $box.find('.text');
        $box.on('click', function () {
            if (ifShow) {
                return;
            }
            ifShow = true;
            var now = new Date();
            var days = {};
            var years = {};
            var months = { 1: '1月', 2: '2月', 3: '3月', 4: '4月', 5: '5月', 6: '6月', 7: '7月', 8: '8月', 9: '9月', 10: '10月', 11: '11月', 12: '12月' };
            var hours = {};
            var minute = {}

            for (var i = 0; i < 24; i++) {
            }

            for (var i = 0; i < 60; i++) {
                minute[i.length == 1 ? '0' + i : i] = i.length == 1 ? '0' + i : i;
                if (i < 24) {
                    hours[i] = i;
                }
                if (i < 31) {
                    days[i + 1] = i + 1;
                }
            }


            for (i = now.getFullYear(); i < now.getFullYear() + 20; i++) {
                years[i] = i;
            }

            SpinningWheel.addSlot(years, 'right', now.getFullYear());
            SpinningWheel.addSlot(months, 'right', now.getMonth() + 1);
            SpinningWheel.addSlot(days, 'right', now.getDate());
            SpinningWheel.addSlot(hours, 'right', now.getHours());
            SpinningWheel.addSlot(minute, 'right', now.getMinutes());

            SpinningWheel.setCancelAction(function () {
                ifShow = false;
            });
            SpinningWheel.setDoneAction(function () {
                var results = SpinningWheel.getSelectedValues();
                var times = results.keys.toString().split(',');
                $text.html();
                $time.val(times[0] + '-' + times[1] + "-" + times[2] + ' ' + times[3] + ':' + times[4]);
                ifShow = false;
            });

            SpinningWheel.open();
        });
    })
</script>

<script>
    $(function () {
        var ifShow = false;
        var $box = $("#js_times1");
        var $time = $box.find('input');
        var $text = $box.find('.text');
        $box.on('click', function () {
            if (ifShow) {
                return;
            }
            ifShow = true;
            var now = new Date();
            var days = {};
            var years = {};
            var months = { 1: '1月', 2: '2月', 3: '3月', 4: '4月', 5: '5月', 6: '6月', 7: '7月', 8: '8月', 9: '9月', 10: '10月', 11: '11月', 12: '12月' };
            var hours = {};
            var minute = {}

            for (var i = 0; i < 24; i++) {
            }

            for (var i = 0; i < 60; i++) {
                minute[i.length == 1 ? '0' + i : i] = i.length == 1 ? '0' + i : i;
                if (i < 24) {
                    hours[i] = i;
                }
                if (i < 31) {
                    days[i + 1] = i + 1;
                }
            }


            for (i = now.getFullYear(); i < now.getFullYear() + 20; i++) {
                years[i] = i;
            }

            SpinningWheel.addSlot(years, 'right', now.getFullYear());
            SpinningWheel.addSlot(months, 'right', now.getMonth() + 1);
            SpinningWheel.addSlot(days, 'right', now.getDate());
            SpinningWheel.addSlot(hours, 'right', now.getHours());
            SpinningWheel.addSlot(minute, 'right', now.getMinutes());

            SpinningWheel.setCancelAction(function () {
                ifShow = false;
            });
            SpinningWheel.setDoneAction(function () {
                var results = SpinningWheel.getSelectedValues();
                var times = results.keys.toString().split(',');
                $text.html();
                $time.val(times[0] + '-' + times[1] + "-" + times[2] + ' ' + times[3] + ':' + times[4]);
                ifShow = false;
            });

            SpinningWheel.open();
        });
    })
</script>
<script type="text/javascript" src="../addons/weilive/style/js/zepto.form.js"></script>
	<script type="text/javascript">		
		//图片上传

		var btn = $("body");
	
		$("#file").wrap('<form method="post" id="formUpload" action="{php echo $this->createMobileUrl('uploadimage');}" enctype="multipart/form-data"></form>');			
		$("#file").change(function(){
			document.getElementById('fileimg').style.display = 'none';
			document.getElementById('aaa').innerHTML = '正在上传，请耐心等候...';
			$("#formUpload").ajaxSubmit({
				dataType:  'json',
				beforeSend: function() {
				
		
				},
				uploadProgress: function(event, position, total, percentComplete) {
			
				},
				success: function(data) {
					
					if(data.error==1) {
						
					}else{
						var pic_url = data.filename;
						$('.fileimg').attr('src','{$_W['attachurl']}'+pic_url);
						$('#pic_url').attr('value',pic_url);
						document.getElementById('fileimg').style.display = 'block';
						document.getElementById('aaa').innerHTML = '';
						//window.location.href='cut?path='+data;
					}
				},
				error:function(xhr){
					btn.html("上传失败3");
				}
			});
		});
</script>
</html>